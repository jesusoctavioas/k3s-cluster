---
- name: Test Raspberry Pi model
  ansible.builtin.command:
    cmd: grep 'Raspberry Pi' /proc/device-tree/model
  changed_when: model.rc != 0
  register: model

- name: Set Raspberry Pi fact
  ansible.builtin.set_fact:
    raspberry_pi: true
  when:
    - ansible_facts.lsb.id | default('') == pi_lsbid
    - ansible_facts.machine | default('') == 'aarch64'
    - model.rc == 0
